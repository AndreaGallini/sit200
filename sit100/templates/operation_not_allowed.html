{% extends 'base.html' %}

{% block title %}Operazione non consentita - {% endblock %}

{% block content %}
<div class="flex flex-col justify-center items-center px-4 py-16 min-h-screen">
    <div class="text-center">
        <h1 class="text-9xl font-bold text-gray-800 dark:text-gray-100">403</h1>
        <h2 class="mt-4 mb-8 text-4xl font-semibold text-gray-700 dark:text-gray-300">Operazione non consentita</h2>
        <p class="mb-12 text-lg text-gray-600 dark:text-gray-400">
            Non è possibile completare l'operazione richiesta o tornare alla pagina precedente.
        </p>
        <button onclick="goBack()" class="px-6 py-3 font-medium text-white rounded-lg transition-colors duration-300 bg-main_color hover:bg-main_color_secondary">
            Torna alla pagina sicura
        </button>
    </div>
</div>

<script>
function goBack() {
    // Lista di pagine protette da non tornare
    const protectedPages = [
        '/project/dove/',
        '/project/dove'
    ];
    
    // Se c'è un referrer valido e non è una pagina protetta
    if (document.referrer) {
        let refUrl = new URL(document.referrer);
        let refPath = refUrl.pathname;
        
        // Controlla se il referrer è una pagina protetta
        let isProtected = protectedPages.some(page => refPath.includes(page));
        
        if (!isProtected) {
            window.location.href = document.referrer;
            return;
        }
    }
    
    // Se non c'è history valida o il referrer è una pagina protetta, vai alla dashboard
    window.location.href = "{% url 'dashboard' %}";
}
</script>
{% endblock %} 